extend layout

block styleBlock 
    style. 

        .form-control-sm { height: 40px }

        .text-center .fa { color: #999 }

block content 
    .container.px-3
        .row.mt-1.gx-4
            .col-md-8
                .pt-4(style="background: #fff; border-radius: 10px; border: 1px solid #f0f0f0")
                    h5.ms-2.mb-3 [ WAREHOUSES ]
                    table.table 
                        tr 
                            th Warehouse 
                            th Region 
                            th(width='110') Action
                        tr.bg-light 
                            form(action='/save-warehouse' method='post')
                                td 
                                    input.form-control.form-control-sm(name='name' type='text')
                                td
                                    select.form-control.form-control-sm(name='regionId')
                                        option(value='') -- Region --
                                        each region in regions 
                                            option(value=`${region.id}`)= region.name
                                td 
                                    button.btn.btn-secondary
                                        i.fa.fa-save 
                                        | &nbsp;Save
                        each warehouse in warehouses 
                            tr 
                                td.ps-3= warehouse.name 
                                td= warehouse.DeliveryRegion.name 
                                td.text-center 
                                    a(href=`/edit-warehouse/${warehouse.id}` title="Edit Warehouse" style="margin-right: 9px")
                                        i.fa.fa-pencil

                                    a.delete(href="#" onClick=`deleteWarehouse(${warehouse.id}, this.parentElement)` title="Delete Warehouse")
                                        i.fa.fa-trash

            .col-md-4
                .pt-4(style="background: #fff; border-radius: 10px; border: 1px solid #f0f0f0")
                    h5.ms-2.mb-3 [ REGIONS ]
                    table.table
                        tr 
                            th Region 
                            th Action 
                        tr.bg-light 
                            form(action='/save-region' method='post')
                                td 
                                    input.form-control.form-control-sm(name='name' type='text')
                                td 
                                    button.btn.btn-secondary
                                        i.fa.fa-save 
                                        | &nbsp;Save
                        each region in regions
                            tr 
                                td.ps-3= region.name 
                                td.text-center 
                                    a(href=`/edit-reqion/${region.id}` title="Edit Region" style="margin-right: 9px")
                                        i.fa.fa-pencil

                                    a.delete-region(href="#" onClick=`deleteRegion(${region.id}, this.parentElement)` title="Delete Region")
                                        i.fa.fa-trash

block scriptBlock
    script. 

        async function deleteRegion(regionId, ele) {            
            if (confirm('Are you sure you want to delete this region?')) {
                const resp = await fetch(`/region/${regionId}`, { method: 'DELETE' });
                const res = await resp.json();
                if (res.status == 'success') {
                    ele.parentElement.style.transition = '0.8s';
                    ele.parentElement.style.opacity = 0;
                    setTimeout(() => {
                        ele.parentElement.remove();
                    }, 700);
                } else {
                    alert(res.message);
                }
            }
        }

        async function deleteWarehouse(warehouseId, ele) {            
            if (confirm('Are you sure you want to delete this warehouse?')) {
                const resp = await fetch(`/warehouse/${warehouseId}`, { method: 'DELETE' });
                const res = await resp.json();
                if (res.status == 'success') {
                    ele.parentElement.style.transition = '0.8s';
                    ele.parentElement.style.opacity = 0;
                    setTimeout(() => {
                        ele.parentElement.remove();
                    }, 700);
                } else {
                    alert(res.message);
                }
            }
        }

